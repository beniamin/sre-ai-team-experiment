- name: Update apt cache
  apt:
    update_cache: yes

- name: Install containerd and dependencies
  apt:
    name: ["ca-certificates","curl","gnupg","lsb-release","containerd"]
    state: present

- name: Configure sysctl for Kubernetes
  sysctl:
    name: net.ipv4.ip_forward
    value: '1'
    state: present
    reload: yes

- name: Disable swap
  command: swapoff -a
  ignore_errors: yes

- name: Ensure required packages for kubeadm
  apt:
    name: ["apt-transport-https","curl"]
    state: present
